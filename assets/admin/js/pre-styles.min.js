((r,s)=>{window.zyrePreStylesInitialized=window.zyrePreStylesInitialized||{};var e=s.modules.controls.Select.extend({onReady:function(){window.zyrePreStylesStore=window.zyrePreStylesStore||{},window.zyrePreStylesCached=window.zyrePreStylesCached||{},window.currentSelectedValue=this.ui.select.val(),window.zyrePreStylesInitialized[this.getWidgetID()]||(this.fetchStyles(!this.isDuplicated()),window.zyrePreStylesInitialized[this.getWidgetID()]=!0)},onRender:function(){this.constructor.__super__.onRender.apply(this,arguments),this.addClearButton()},onElementChange:function(){this.$el.find(".zyre-reset-style").removeAttr("disabled")},addSyncButton:function(){var e=this;this.ui.select.closest(".elementor-control-field").find(".elementor-control-title").prepend('<span class="zyre-sync-button" title="Sync the current prestyle."><i class="eicon-sync" aria-hidden="true"></i></span>'),this.$el.find(".zyre-sync-button").on("click",function(){e.onSyncClick()})},onSyncClick:function(){this.fetchStyles(!0)},addClearButton:function(){var e=this;this.ui.select.parent().prev().after('<button class="zyre-reset-style" title="Clear the current preset, reload the editor to repeat this action."><i class="eicon-trash-o" aria-hidden="true"></i> Clear</button>'),this.$el.find(".zyre-reset-style").on("click",function(){e.onClearClick()})},onClearClick:function(){var e=this.ui.select.val(),t=this.getStylesMerged(!0);t[e]&&window.confirm(zyrePreStyles.resetStyleAlert)&&this.clearStyle(t[e])},getElementSettingsModel:function(){return this.container.settings},getWidgetAction:function(){var e=this.container.document.history.currentItem?.attributes;return void 0!==e?.action?e.action.toLowerCase():""},isDuplicated:function(){return"duplicate"===this.getWidgetAction()},getWidgetName:function(){return this.getElementSettingsModel().get("widgetType")},getWidgetID:function(){return this.container.model.id},isProWidget:function(){var e=this.container.view.el;return r(e).hasClass("zyre-addon-pro")},fetchStyles:function(n=!1,e=!1){var t,i=this;this.getWidgetName()&&(t=s.config.initial_document.id,t={action:"zyre_widget_set_prestyle",widget:this.getWidgetName(),widgetID:this.getWidgetID(),isPro:this.isProWidget(),post_id:t,security:zyrePreStyles.security},e&&(t.reset=!0),r.get(zyrePreStyles.ajaxUrl,t).done(function(e){var t;e.success&&(i.setStyles(e.data),n)&&(e=i.ui.select.val(),(t=i.getStyles())[e])&&i.applyStyle(t[e])}))},setStyles:function(e){window.zyrePreStylesStore[this.getWidgetName()]=JSON.parse(e)},getStyles:function(){return window.zyrePreStylesStore[this.getWidgetName()]||{}},onBaseInputChange:function(e){var t;this.constructor.__super__.onBaseInputChange.apply(this,arguments),e.currentTarget.value&&(e=e.currentTarget.value,this.cacheCurrentStyle(window.currentSelectedValue),window.currentSelectedValue=e,(t=this.getStylesMerged())[e])&&this.applyStyle(t[e])},cacheCurrentStyle:function(e){var t=this.getElementSettingsModel().toJSON(),n=this.ui.select.attr("data-setting")||"",n=(t.hasOwnProperty(n)&&(t[n]=e),this.getWidgetID());window.zyrePreStylesCached[n]||(window.zyrePreStylesCached[n]={}),window.zyrePreStylesCached[n][e]||(window.zyrePreStylesCached[n][e]={}),window.zyrePreStylesCached[n][e]=t},getStylesCached:function(){return window.zyrePreStylesCached||{}},getStylesMerged:function(e=!1){var t=this.getStylesCached()[this.getWidgetID()],n=this.getStyles();return e?{...t,...n}:{...n,...t}},applyStyle:function(n){var e=this.getElementSettingsModel().controls,i={};_.each(e,function(e,t){"repeater"!==e.type&&n.hasOwnProperty(t)&&(""===n[t]?i[t]="":i[t]=n[t])}),this.getElementSettingsModel().setExternalChange(i),this.container.render()},clearStyle:function(n){var i=this.getWidgetName().replace(/^zyre-/,"")+"_style",e=this.getElementSettingsModel().controls,r=this.getElementSettingsModel().defaults,s={};_.each(e,function(e,t){"repeater"===e.type||!n.hasOwnProperty(t)||void 0!==i&&i===t||(s[t]=r[t])}),this.getElementSettingsModel().setExternalChange(s),this.container.render()},resetStyle:function(n){var i=this.getElementSettingsModel().defaults,e=this.getElementSettingsModel().controls,r={};_.each(e,function(e,t){"repeater"!==e.type&&(n.hasOwnProperty(t)?""===n[t]?r[t]="":r[t]=n[t]:r[t]=i[t])}),this.getElementSettingsModel().setExternalChange(r),this.container.render()}});s.addControlView("zyre_style_select",e)})(jQuery,window.elementor);